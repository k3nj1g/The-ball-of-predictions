export const toneSets = {
  darkOmen: {
    omens: [
      'ночь оставила метку на стекле твоих привычек',
      'ворон сел на карниз твоих сомнений',
      'зеркало задержало твой взгляд на лишнюю секунду',
      'лунный свет подсветил то, что ты обычно прячешь',
      'тень у двери знает твой следующий шаг',
      'пепел вчерашних слов сложился в новый знак',
      'тишина в комнате внезапно стала слишком громкой',
      'в случайной фразе уже спрятан чужой ключ',
      'старый маршрут больше не узнаёт тебя',
      'на перекрёстке тебя уже ждёт забытое обещание',
      'холодный ветер перевернул страницу неслучайно',
      'след на пыли ведёт туда, где ты избегала смотреть',
      'неоновая вывеска мигнула в нужный момент',
      'чужая улыбка надела слишком ровную маску',
      'телефон молчит ровно потому, что так надо',
      'твой внутренний компас подозрительно трезв',
      'часы споткнулись о одну и ту же минуту',
      'коридор с привычным светом стал на тон темнее',
      'запах дождя принёс не погоду, а подсказку',
      'чёрная кошка даже не пыталась быть символичной',
      'ключ в кармане внезапно потяжелел',
      'свеча горит ровно, но врёт о спокойствии',
      'чужая тишина звучит как приглашение',
      'луна выбрала тебя наблюдателем этой сцены',
      'случайный поворот оказался запланированным',
      'ночной город повторяет твоё имя без акцента',
      'в твоих заметках уже живёт ответ',
      'тёмное стекло отразило не только тебя',
      'на подоконнике легла пыль в форме стрелки',
      'дверной звонок прозвучит тогда, когда ты перестанешь ждать'
    ],
    warnings: [
      'не доверяй первой улыбке — её репетировали',
      'не объясняйся там, где достаточно уйти',
      'береги слова, которые могут стать клятвой',
      'не спорь с интуицией, она редко берёт выходной',
      'оставь лишние оправдания тем, кто их коллекционирует',
      'не открывай все карты тем, кто играет чужой колодой',
      'не торопись спасать того, кто тонет по привычке',
      'держи дистанцию с теми, кто любит твой свет, но боится твоей правды',
      'проверь факты, прежде чем поверить в красивую версию',
      'не называй случайностью то, что повторяется трижды',
      'не возвращайся в дверь, которую закрыла сама ночь',
      'не обещай вечность на эмоциях вторника',
      'оставь паузу перед любым “да”',
      'не исправляй людей, которые гордятся трещинами',
      'держи план при себе, пока не услышишь тишину согласия',
      'не гаси себя, чтобы кому-то было комфортно',
      'не ведись на срочность, которую тебе навязали',
      'помни: мягкость не обязана быть удобной',
      'выбирай ясность вместо красивой дымки',
      'не бери вину, которую тебе делегировали',
      'закрой диалог, который тебя обескровливает',
      'не вкладывайся туда, где тебя измеряют пользой',
      'сохрани силы для главного разговора',
      'не забывай, что молчание тоже ответ',
      'не бойся быть “слишком точной”',
      'проверяй мотивы, а не декорации',
      'не игнорируй маленькие красные флажки',
      'не лезь в бой, где приз — пустота',
      'не повторяй путь, который уже сломал тебе сон',
      'отложи решение, если внутри один шум'
    ],
    taglines: [
      'Считай это любезностью тьмы.',
      'И нет, это не просьба.',
      'Шар редко ошибается, люди — регулярно.',
      'Можешь проигнорировать. Последствия не смогут.',
      'Если стало не по себе, значит, попало в точку.',
      'Твоя интуиция уже подписала этот документ.',
      'Сюрпризов не будет — только последствия выбора.',
      'Тень аплодирует твоей наблюдательности.',
      'Судьба шепчет. Я просто усилил звук.',
      'Не драматизируй. Просто не делай глупостей.'
    ]
  },
  sardonic: {
    omens: [
      'космос поставил тебе саркастичный лайк',
      'вселенная снова проверяет твой иммунитет к абсурду',
      'карма открыла блокнот и нашла твою фамилию',
      'звёзды устроили совещание без тебя',
      'твой день начал вести себя как чёрная комедия',
      'случайности сегодня выглядят слишком организованно',
      'судьба выбрала для тебя режим “без фильтров”',
      'небо намекает, что пора перестать быть удобной',
      'планеты выстроились в фигуру “ну ты поняла”',
      'реальность подмигнула слишком уверенно',
      'внутренний циник проснулся раньше будильника',
      'в лифте судьбы кто-то нажал не тот этаж',
      'драма сама тебя найдёт, можешь не звонить',
      'луна смотрит на тебя с профессиональным скепсисом',
      'в эфире слышен фирменный шорох перемен',
      'временная линия сегодня с чувством юмора',
      'мелочи решили устроить тебе квест',
      'чужие маски трещат по краям',
      'кто-то снова перепутал твою доброту с доступностью',
      'пыль на полке знает больше, чем твой чат',
      'даже кофе сегодня намекает на стратегию',
      'интуиция пришла с видом “я же говорила”',
      'вечер обещает сюжетный твист без музыки',
      'твоё терпение достигло эстетичного предела',
      'на горизонте новая причина поднять бровь',
      'день выглядит невинно, но это маскировка',
      'вселенная разогревает сарказм до рабочей температуры',
      'твой внутренний детектив уже нюхает подвох',
      'кто-то не готов к твоему честному ответу',
      'в случайном сообщении спрятан непрошеный тест'
    ],
    warnings: [
      'не спасай чужой хаос, у тебя нет такой подписки',
      'не трать остроумие на тех, кто не различает иронию',
      'держи границы там, где другие приносят ножницы',
      'не соглашайся только ради тишины',
      'не компенсируй чужую лень своей дисциплиной',
      'сначала факты, потом драматичный саундтрек',
      'не отвечай мгновенно — пусть понервничают',
      'не бери на себя чужую вину в красивой упаковке',
      'не путай внимание с уважением',
      'не подстраивайся под чужую непоследовательность',
      'не влюбляйся в потенциал, смотри на действия',
      'не путай срочность с важностью',
      'оставь место для “нет” без пояснительной записки',
      'не спорь с теми, кто уже выбрал заблуждение',
      'не трать вечер на разговор, который закончится ничем',
      'не позволяй вежливости отменять самоуважение',
      'не пытайся быть понятной всем — это плохой сериал',
      'не подписывайся на чужие последствия',
      'не раздавай доступ к себе без двухфакторной проверки',
      'держи холодную голову и тёплый чай',
      'не переписывай правду, чтобы кому-то было удобно',
      'сохрани энергию для людей с мозгом и сердцем',
      'не ведись на “последний шанс” от манипуляторов',
      'не спорь с красным флагом, он уже красный',
      'не делай из намёков проект на выходные',
      'не отчитывайся перед теми, кто не в команде',
      'не путай инициативу с обязанностью',
      'держи сарказм острым, но дозированным',
      'не позволяй спешке украсть точность',
      'не забывай: ты не служба спасения'
    ],
    taglines: [
      'Да, мир странный. Ты — нет.',
      'Улыбнись уголком губ и иди дальше.',
      'Это судьба. Не путать с цирком.',
      'Слишком мрачно? Нормально, это стиль.',
      'Шар бы закатил глаза, если бы мог.',
      'Твоё “нет” сегодня особенно элегантно.',
      'Считай это бесплатной консультацией по выживанию.',
      'Сарказм активирован. Пользуйся аккуратно.',
      'Дальше сама. У тебя получается лучше всех.',
      'Никакого сахара. Только чистая интуиция.'
    ]
  },
  arcaneAdvice: {
    omens: [
      'на пороге перемен лежит тихий, но верный знак',
      'ветер принёс тебе редкую ясность',
      'луна подсветила правильный поворот',
      'в тишине возникла неожиданная опора',
      'старый страх теряет над тобой власть',
      'в зеркале заметен новый контур силы',
      'ночь отдала тебе кусочек спокойствия',
      'пауза сегодня работает на тебя',
      'случайная встреча готовит полезный урок',
      'внутренний голос звучит ровно и уверенно',
      'в замедлении ты увидишь главное',
      'круг сомнений наконец-то размыкается',
      'в темноте уже видно направление',
      'у судьбы для тебя сдержанный, но добрый план',
      'сегодня ты заметишь то, что раньше пропускала',
      'прошлое отпускает хватку на один узел',
      'дверь, которую ты боялась, окажется лёгкой',
      'твой ритм синхронизируется с правильными людьми',
      'даже скепсис сегодня работает как защита, а не стена',
      'в пепле дня остаются полезные искры',
      'ответ проявится через спокойствие, не через шум',
      'тень перестаёт пугать, когда смотришь прямо',
      'в одном “нет” спрятано большое “да” себе',
      'лёгкий холод подсказывает верный вектор',
      'ты ближе к цели, чем кажется ночью',
      'тишина вокруг — не пустота, а настройка',
      'знак придёт в обычной форме, не пропусти',
      'доверие к себе возвращается по шагам',
      'сейчас важна не скорость, а точность',
      'сегодняшний вечер даст тебе ясную точку сборки'
    ],
    warnings: [
      'не торопи ответы, которые созревают в тишине',
      'не обесценивай маленькие победы',
      'не сравнивай свой путь с чужой витриной',
      'не держи дверь открытой для старых сценариев',
      'не забывай отдыхать до, а не после выгорания',
      'не объясняй свою глубину тем, кто любит только поверхность',
      'не называй слабостью просьбу о поддержке',
      'не теряй фокус на том, что действительно важно',
      'не позволяй страху говорить твоим голосом',
      'не откладывай разговор, который может освободить',
      'не бойся пересобрать план по ходу',
      'не жди идеального момента, создай рабочий',
      'не закрывай сердце, закрывай только лишний шум',
      'не забывай проверять, что тебе по-настоящему подходит',
      'не расходуй свет на чужое недовольство',
      'не игнорируй сигналы тела и сна',
      'не отменяй себя ради чужого темпа',
      'не выноси приговор до полного контекста',
      'не считай мягкость противоположностью силы',
      'не теряй чувство юмора в серьёзных задачах',
      'не пытайся контролировать то, что нужно прожить',
      'не стирай границы ради мнимого мира',
      'не сдавайся в момент, когда стало ясно',
      'не держи в голове то, что лучше записать',
      'не цепляйся за то, что уже отслужило',
      'не забывай возвращаться к себе каждый вечер',
      'не трать утро на вчерашние тени',
      'не гонись за одобрением вместо смысла',
      'не бойся выбрать более спокойный путь',
      'не умаляй собственную интуицию'
    ],
    taglines: [
      'Спокойно. Ты уже на верной орбите.',
      'Тьма не враг, если держишь курс.',
      'Сила выглядит тихо, но работает точно.',
      'Ты не потерялась, ты перенастраиваешься.',
      'Да, это сложный уровень. Ты справишься.',
      'Пусть будет меньше шума и больше смысла.',
      'Судьба уважает тех, кто уважает себя.',
      'Остальное приложится, когда ты не суетишься.',
      'Это не магия. Это дисциплина души.',
      'Мягко — не значит слабо.'
    ]
  }
};

const extraSlots = {
  prefaces: [
    'прими это как спокойное предупреждение',
    'в сегодняшнем тумане есть редкая ясность',
    'это тот случай, когда интуиция права раньше логики',
    'в твоём маршруте появился новый узел',
    'судьба говорит тихо, но очень конкретно',
    'ночь подсветила детали без лишней драмы',
    'вокруг тебя смещаются акценты',
    'даже случайности сегодня ведут себя дисциплинированно',
    'день подготовил тебе не самый мягкий, но полезный урок',
    'в этом знаке больше практики, чем мистики',
    'ты стоишь у точки тонкой перенастройки',
    'в шуме наконец слышно главное',
    'внутренний радар зафиксировал движение',
    'пауза вокруг тебя не пустая, а рабочая',
    'время убрать всё лишнее из фокуса'
  ],
  turners: [
    'если услышишь сомнение — проверь факты и иди дальше',
    'если станет тревожно — сократи круг доверия',
    'если кто-то давит на скорость — выбери точность',
    'если попросят удобства — выбери честность',
    'если сюжет повторяется — меняй правила',
    'если тянет назад — закрывай старые двери без речи',
    'если всё слишком гладко — присмотрись к деталям',
    'если внутри шум — сначала тишина, потом решения',
    'если чужое мнение громче твоего — убавь внешний звук',
    'если обещают лёгкий путь — уточняй цену',
    'если не хватает опоры — вернись к простому плану',
    'если хочется объясняться — проверь, тебя вообще слышат?',
    'если нужно выбирать — выбирай то, после чего легче дышать',
    'если тебя торопят — это уже подсказка',
    'если всё расплывается — запиши три главных шага'
  ],
  closers: [
    'Да, это звучит сурово. Зато работает.',
    'Считай это редкой формой заботы от тьмы.',
    'Тон мрачный, выводы — полезные.',
    'Никакой паники. Только дисциплина выбора.',
    'Судьба не шутит. Я иногда — да.',
    'Можно спорить. Но лучше подготовиться.',
    'Эстетика ночи, практичность утра.',
    'И да, это была самая мягкая версия формулировки.',
    'Вежливое напоминание: ты сильнее, чем думаешь.',
    'Пусть это станет твоим тихим преимуществом.',
    'Темнота здесь для контраста, не для страха.',
    'Главное уже сказано. Остальное — дело шага.',
    'Ты справишься. Без аплодисментов, но красиво.',
    'Считай, что это персональный апдейт реальности.',
    'На этом шар завершает брифинг.'
  ]
};

function hashName(value) {
  let hash = 0;
  for (let i = 0; i < value.length; i += 1) {
    hash = (hash << 5) - hash + value.charCodeAt(i);
    hash |= 0;
  }
  return Math.abs(hash);
}

function pick(arr, randomizer) {
  return arr[Math.floor(randomizer() * arr.length)];
}

function createSeededRandom(seed) {
  let state = seed % 2147483647;
  if (state <= 0) state += 2147483646;
  return () => {
    state = (state * 16807) % 2147483647;
    return (state - 1) / 2147483646;
  };
}

export function generatePrediction(name, useSeed = true) {
  const cleanName = name.trim();
  const normalizedName = cleanName.charAt(0).toUpperCase() + cleanName.slice(1);
  const randomizer = useSeed ? createSeededRandom(hashName(normalizedName)) : Math.random;

  const tones = Object.values(toneSets);
  const tone = pick(tones, randomizer);

  const omen = pick(tone.omens, randomizer);
  const warning = pick(tone.warnings, randomizer);
  const tagline = pick(tone.taglines, randomizer);
  const preface = pick(extraSlots.prefaces, randomizer);
  const turner = pick(extraSlots.turners, randomizer);
  const closer = pick(extraSlots.closers, randomizer);

  const templates = [
    `${normalizedName}, сегодня ${omen}. ${warning}. ${tagline}`,
    `${normalizedName} — ${omen}. ${warning}. ${tagline}`,
    `${normalizedName}, знак ясен: ${omen}. ${warning}. ${tagline}`,
    `${normalizedName}, ${preface}: ${omen}. ${warning}. ${closer}`,
    `${normalizedName}, ${omen}. И ещё: ${turner}. ${tagline}`,
    `${normalizedName} — ${preface}. Сегодня ${omen}, поэтому ${turner}. ${closer}`,
    `${normalizedName}, наблюдение шара: ${omen}. ${warning}. ${turner}.`,
    `${normalizedName}, ${preface}. ${warning}. ${tagline} ${closer}`
  ];

  return {
    id: `p_${Date.now().toString(36)}`,
    text: pick(templates, randomizer),
    createdAt: new Date().toISOString()
  };
}
